#!/usr/bin/env bash

h=/home/aghost-7
run-dev() {
	name=$1
	tag=$2
	xhost +si:localuser:$USER > /dev/null
	docker run -ti \
		--privileged \
		--rm --name $name \
		-v `readlink -f /var/run/docker.sock`:/var/run/docker.sock \
		-v $HOME/workspaces:$h/workspaces \
		-v $SSH_AUTH_SOCK:$SSH_AUTH_SOCK \
		-e SSH_AUTH_SOCK=$SSH_AUTH_SOCK \
		-v $HOME/.gitconfig:$h/.gitconfig \
		-v $HOME/.ssh/known_hosts:$h/.ssh/known_hosts \
		-e DISPLAY=$DISPLAY \
		-v /tmp/.X11-unix:/tmp/.X11-unix:ro \
		aghost7/$name:$tag \
		bash
}

case "$1" in
	py)
		run-dev py-dev 2.7
		;;
	rust)
		run-dev rust-dev stable
		;;
	node)
		run-dev nodejs-dev v4.4.4
		;;
	scala)
		run-dev scala-dev latest
		;;
	*)
		echo Bad argument \"$1\"
		exit 1
		;;
esac
